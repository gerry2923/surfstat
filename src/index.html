<!DOCTYPE html>
<html lang="ru">
  @@include('html/head.html', {
    title: "Surfstat"
  })

<body>

  
  @@include('html/header.html', {
    logo: "#"
  })
  
    <main class="main-layout">
      <h1 class="visually-hidden">Сервис Surfstat для анализа спроса и предложения на торговой площадке Wildberries</h1>
  
      <section class="promo">
        <div class="container">
          <div class="promo__wrapper">
            <h2 class="promo__title">Анализ спроса <br>и предложений на Wildberries</h2>
            <ul class="promo__list">
              <li class="promo__item">Топ запросов</li>
              <li class="promo__item">Внеконкурентные ниши</li>
              <li class="promo__item">Похожие товары</li>
              <li class="promo__item">Взрывные тренды</li>
            </ul>
            <p class="promo__subtitle">Первым достается все, остальным остальное</p>
            <a href="registration-trial.html" class="promo__button">Попробовать бесплатно</a>
          </div>
        </div>
      </section>
  
      <section class="requests-table container">
        <div class="requests-table__wrapper">
          <h2 class="visually-hidden">Аналитическая таблица поисковых запросов</h2>
  
          <div class="requests-table__header t-header">
            <p class="t-header__text">Введите интересующий вас запрос и отслеживайте растущие тренды с низкой конкуренцией.</p>
  
            <div class="t-header__search">
              <input type="text" class="t-header__input" id="requestInput" placeholder="Введите запрос">
              <button class="t-header__input-btn" type="submit"></button>
            </div>
  
            <div class="t-header__requests-filters">
              <input type="radio" name="requests-filter" id="rq-top" checked>
              <label class="button t-header__requests-filters_top" for="rq-top">Топ запросов</label>
  
              <input type="radio" name="requests-filter" id="rq-search">
              <label class="button t-header__requests-filters_search" for="rq-search">Поисковые запросы</label>
  
              <input type="radio" name="requests-filter" id="rq-similar">
              <label class="button t-header__requests-filters_similar" for="rq-similar">Похожие запросы</label>
            </div>
  
            <div class="t-header__results-filter">
              <button type="button" class="t-header__results-filter_ditails button button_small" onpointerdown="openCloseDescriptionCard()">Подробнее</button> 
              <button class="t-header__results-filter_filter button button_small" type="button" id="filters">Фильтры</button>
              <button class="t-header__results-filter_time button button_small" type="button">За 1 неделю</button>
            </div>
  
          </div>
  
          <div class="table">
           @@include('html/table.html', {})
          </div>
  
          <div class="requests-table__footer">
            <div class="pagination">
              <a href="#">prev</a>
              <a href="#">1</a>
              <a href="#">2</a>
              <a href="#">3</a>
              <a href="#">...</a>
              <a href="#">10</a>
              <a href="#">next</a>
            </div>
  
            <button class="btn-share" type="button">Поделиться</button>
          </div>
  
        </div>
      </section>
  
      <section class="rates">
        <h2 class="visually-hidden">Выберите подходящий тариф</h2>
        <div class="container">
          <p class="rates__subtitle">Находите взрывные тренды, анализируйте конкурентов
          и повышайте свою прибыль</p>
          <a href="registration-trial.html" class="rates__free">Поробовать бесплатно</a>
          <a href="registration.html" class="rates__buy">Оплатить тариф</a>
        </div>
  
      </section>
    </main>
  
  @@include('html/footer.html', {})
  
  <template class="card-template">
    <div class="card container">
      <h2 class="visually-hidden"></h2>
      <button class="card__close-btn" type="button"></button>
    
      <ul class="card__header">
        <li class="card__header-item">
          <input type="radio" class="card__input" name="card_name" checked>
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input" name="card_name">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input" name="card_name">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input" name="card_name">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input" name="card_name">
        </li>
      </ul>
    
      <ul class="card__content">
        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="" class="card__label">Динамика запросов относительно предыдущего месяца.</label>
          </div>
        </li>
      </ul>
    
      <button class="card__reset-btn" type="button">Сбросить фильтр</button>
    </div>
  </template>

    <div class="card tips container" style="display: none;">
      <h2 class="visually-hidden">Подсказки параметров запроса</h2>
      <button class="card__close-btn tips__close-btn" type="button"></button>
    
      <ul class="card__header">
        <li class="card__header-item">
          <input type="radio" class="card__input tips__input" name="tips-radio" id="request" checked>
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input tips__input" name="tips-radio" id="demand">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input tips__input" name="tips-radio" id="trend">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input tips__input" name="tips-radio" id="supply">
        </li>
    
        <li class="card__header-item">
          <input type="radio" class="card__input tips__input" name="tips-radio" id="competing">
        </li>
      </ul>
    
      <ul class="card__content">
        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="request" class="card__label tips__label">То слово или фраза, которые пользователи вводят в поисковую строку.</label>
          </div>
        </li>

        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="demand" class="card__label tips__label">Количествово запросов, набранных пользователями в поисковой строке.</label>
          </div>
        </li>

        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="trend" class="card__label tips__label">Количество товарных карточек по запросу.</label>
          </div>
        </li>

        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="supply" class="card__label tips__label">Динамика запроса относительно предыдущего месяца.</label>
          </div>
        </li>

        <li class="card__content-item">
          <p class="card__text">Выберете интересующий вас параметр</p>
          <div class="card__content-wrapper">
            <label for="competing" class="card__label tips__label">Соотношение спроса к предложению.</label>
          </div>
        </li>
      </ul>
    
      <button class="card__reset-btn tips__reset-btn" type="button">Сбросить фильтр</button>
    </div>

    <form action="">
      <div class="card filter container">
        <h2 class="visually-hidden">Фильтры таблицы статистики</h2>
        <button class="card__close-btn filter__close-btn" type="submit"></button>
      
        <ul class="card__header">
          <li class="card__header-item filter__header-item">
            <input type="radio" class="card__input filter__input" name="filter_name" id="filter-popularity" checked>
          </li>
      
          <li class="card__header-item filter__header-item">
            <input type="radio" class="card__input filter__input" name="filter_name" id="filter-trend">
          </li>
      
          <li class="card__header-item filter__header-item">
            <input type="radio" class="card__input filter__input" name="filter_name" id="filter-demande-nmbr">
          </li>
      
          <li class="card__header-item filter__header-item">
            <input type="radio" class="card__input filter__input" name="filter_name" id="filter-competing">
          </li>
        </ul>
      
        <ul class="card__content">
          <li class="card__content-item">
            <p class="card__text">Выберете границы значений частности запросов</p>
            <div class="card__content-wrapper">
              <label for="filter-popularity" class="card__label filter__label"></label>
              <form>
                <div id="popularity-slider-scroll"></div>
                <div class="popularity-slider__input-container">
                  <input type="text" id="popularity-input-min" value="0">
                  <input type="text" id="popularity-input-max" value="100">
                </div>
              </form>
              
            </div>
          </li>

          <li class="card__content-item" style="display:none">
            <p class="card__text">Выберете тренд:<br>положительный или отрицательный</p>
            <div class="card__content-wrapper">
              <label for="filter-trend" class="card__label filter__label"></label>
            </div>
          </li>

          <li class="card__content-item" style="display:none">
            <p class="card__text">Выберете границы значений количества карточек в выдаче</p>
            <div class="card__content-wrapper">
              <label for="filter-demande-nmbr" class="card__label filter__label"></label>
            </div>
          </li>

          <li class="card__content-item" style="display:none">
            <p class="card__text">Выберете границы соотношения спроса к предложению</p>
            <div class="card__content-wrapper">
              <label for="filter-competing" class="card__label filter__label"></label>
            </div>
          </li>
        </ul>
      
        <button class="card__reset-btn filter__reset-btn" type="button">Сбросить фильтр</button>
      </div>
    </form>


<script src="js/app.min.js"></script>
<!-- карточка с подсказками фильтров таблицы-->
<script>
  const openTipsCard = document.querySelector('.t-header__results-filter_ditails');
  const closeTipsCard = document.querySelector('.tips__close-btn');
  const tipsCard = document.querySelector('.tips');

  const inputTipsList = document.querySelectorAll('.tips__input');
  const labelTispList = document.querySelectorAll('.tips__label');
  
  const initpage = () => {
    console.log('initpage...');

    const resetTipsCard = () => {
      inputTipsList.item(0).checked = true;
      setDisplayLabel(inputTipsList.item(0).id);
    };

    const onCloseOpenTipsCard = () => {
      if(tipsCard.classList.contains('tips_disabled')) {
        tipsCard.classList.remove('tips_disabled');
        resetTipsCard();
      } else {
        tipsCard.classList.add('tips_disabled');
      }
    };

    const setDisplayLabel  = (id) => {

      labelTispList.forEach( (label) => {
        const tipLabelListItem = label.parentElement.parentElement;

        if(label.htmlFor === id) { 
          tipLabelListItem.style.display = 'block';
        } else {
          tipLabelListItem.style.display = 'none';
        }
      });
    };

    const onCheckedRadioTips = evt => setDisplayLabel(evt.target.id);

    openTipsCard.addEventListener('pointerdown', onCloseOpenTipsCard);
    closeTipsCard.addEventListener('pointerdown', onCloseOpenTipsCard);
    
    inputTipsList.forEach(inputElement => {
      inputElement.addEventListener('change', onCheckedRadioTips);
    });

    setDisplayLabel(inputTipsList.item(0).id);

    const popularitySlider = document.querySelector('.popularity-slider');

  
  };
  
  document.addEventListener('DOMContentLoaded', initpage);


</script>


<script>

const sliderElement = document.querySelector('.popularity-slider-scroll');
const inputMin = document.getElementById('popularity-input-min');
const inputMax = document.getElementById('popularity-input-max');
const inputs = [inputMin, inputMax];

console.log(sliderElement);
console.log(inputs);

noUiSlider.create(sliderElement, {
  start: [20, 80],
  connect: true,
  tooltips: true,
  range: {
      'min': 0,
      'max': 100
  },
  format: wNumb({
    decimals: 0,
    thousand: '.',
  }),

  
});

sliderElement.noUiSlider.on('update', function(values, handle) {
  inputs[handle].value = values[handle];
});

// Listen to keydown events on the input field.
inputs.forEach(function (input, handle) {

  input.addEventListener('change', function () {
      sliderElement.noUiSlider.setHandle(handle, this.value);
  });

  input.addEventListener('keydown', function (e) {

      var values = sliderElement.noUiSlider.get();
      var value = Number(values[handle]);

      // [[handle0_down, handle0_up], [handle1_down, handle1_up]]
      var steps = sliderElement.noUiSlider.steps();

      // [down, up]
      var step = steps[handle];

      var position;

      // 13 is enter,
      // 38 is key up,
      // 40 is key down.
      switch (e.which) {

          case 13:
              sliderElement.noUiSlider.setHandle(handle, this.value);
              break;

          case 38:

              // Get step to go increase slider value (up)
              position = step[1];

              // false = no step is set
              if (position === false) {
                  position = 1;
              }

              // null = edge of slider
              if (position !== null) {
                  sliderElement.noUiSlider.setHandle(handle, value + position);
              }

              break;

          case 40:

              position = step[0];

              if (position === false) {
                  position = 1;
              }

              if (position !== null) {
                  sliderElement.noUiSlider.setHandle(handle, value - position);
              }

              break;
      }
  });
});
</script>
</body>

</html>